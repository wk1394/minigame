<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è‹±è¯­å•è¯åˆ†ç±»æ¸¸æˆ</title>
<style>
body {
    font-family: 'Comic Sans MS', Arial, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    position: relative;
    overflow-x: hidden;
}
h1 { 
    color: #fff; 
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    animation: bounce 2s infinite;
}
@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}
@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(5deg); }
}
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px) rotate(-5deg); }
    75% { transform: translateX(10px) rotate(5deg); }
}
@keyframes celebrate {
    0% { transform: scale(1) rotate(0deg); }
    25% { transform: scale(1.2) rotate(5deg); }
    50% { transform: scale(1.1) rotate(-5deg); }
    75% { transform: scale(1.2) rotate(5deg); }
    100% { transform: scale(1) rotate(0deg); }
}
#gameContainer {
    background: rgba(255,255,255,0.95);
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    max-width: 900px;
    width: 100%;
}
#controls {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    justify-content: center;
}
.btn {
    padding: 12px 25px;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: bold;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
}
.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.3);
}
#resetBtn {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
}
#difficultyBtn {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: white;
}
#soundBtn {
    background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
    color: white;
}
#words {
    display: flex;
    flex-wrap: wrap;
    margin-bottom: 30px;
    min-height: 80px;
    justify-content: center;
    gap: 10px;
}
.word {
    background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    color: white;
    padding: 12px 20px;
    border-radius: 15px;
    cursor: grab;
    font-weight: bold;
    font-size: 16px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    transition: all 0.3s;
    animation: float 3s ease-in-out infinite;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}
.word:hover {
    transform: scale(1.1) rotate(5deg);
}
.word:active {
    cursor: grabbing;
}
#categories {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
}
.category {
    width: 180px;
    min-height: 200px;
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    border: 4px dashed #667eea;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    flex-direction: column;
    padding: 15px;
    transition: all 0.3s;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
.category:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}
.category.drag-over {
    background: linear-gradient(135deg, #fed6e3 0%, #a8edea 100%);
    border-color: #f5576c;
    transform: scale(1.08);
}
.category h3 {
    margin-bottom: 15px;
    color: #667eea;
    font-size: 18px;
    text-align: center;
    text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
}
.category .word {
    margin: 5px 0;
    width: calc(100% - 20px);
    text-align: center;
    animation: none;
}
#scoreBoard {
    display: flex;
    gap: 30px;
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
    justify-content: center;
}
.score-item {
    background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
    padding: 15px 25px;
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    color: #333;
}
.correct {
    background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%) !important;
    animation: celebrate 0.6s ease;
}
.wrong {
    background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%) !important;
    animation: shake 0.5s ease;
}
#particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1000;
}
.particle {
    position: absolute;
    width: 10px;
    height: 10px;
    background: gold;
    border-radius: 50%;
    animation: particle-fall 2s ease-out forwards;
}
@keyframes particle-fall {
    to {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
    }
}
#timer {
    font-size: 24px;
    color: #667eea;
    font-weight: bold;
    margin-bottom: 15px;
    text-align: center;
}
.finished {
    opacity: 0.6;
    pointer-events: none;
}
</style>
</head>
<body>

<h1>ğŸ® è‹±è¯­å•è¯åˆ†ç±»æ¸¸æˆ</h1>

<div id="gameContainer">
    <div id="controls">
        <button class="btn" id="resetBtn">ğŸ”„ é‡æ–°å¼€å§‹</button>
        <button class="btn" id="difficultyBtn">âš™ï¸ éš¾åº¦: ç®€å•</button>
        <button class="btn" id="soundBtn">ğŸ”Š éŸ³æ•ˆ</button>
    </div>
    
    <div id="timer">â±ï¸ æ—¶é—´: 00:00</div>
    
    <div id="words"></div>
    <div id="categories"></div>
    
    <div id="scoreBoard">
        <div class="score-item">â­ å¾—åˆ†: <span id="score">0</span></div>
        <div class="score-item">âœ… æ­£ç¡®: <span id="correct">0</span></div>
        <div class="score-item">âŒ é”™è¯¯: <span id="wrong">0</span></div>
    </div>
</div>

<div id="particles"></div>

<script>
// éŸ³é¢‘ä¸Šä¸‹æ–‡
const audioContext = new (window.AudioContext || window.webkitAudioContext)();
let soundEnabled = true;

// éŸ³æ•ˆå‡½æ•°
function playSound(type) {
    if (!soundEnabled) return;
    
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    const now = audioContext.currentTime;
    
    switch(type) {
        case 'correct': // æ­£ç¡® - æ¬¢å¿«çš„ä¸Šå‡éŸ³
            oscillator.frequency.setValueAtTime(523, now); // C5
            oscillator.frequency.exponentialRampToValueAtTime(659, now + 0.08); // E5
            oscillator.frequency.exponentialRampToValueAtTime(784, now + 0.16); // G5
            oscillator.frequency.exponentialRampToValueAtTime(1047, now + 0.24); // C6
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            oscillator.type = 'sine';
            oscillator.start(now);
            oscillator.stop(now + 0.3);
            break;
            
        case 'wrong': // é”™è¯¯ - æŸ”å’Œçš„æç¤ºéŸ³
            oscillator.frequency.setValueAtTime(300, now);
            oscillator.frequency.exponentialRampToValueAtTime(200, now + 0.2);
            gainNode.gain.setValueAtTime(0.2, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.2);
            oscillator.type = 'sine';
            oscillator.start(now);
            oscillator.stop(now + 0.2);
            break;
            
        case 'pickup': // æ‹¾å–å•è¯ - è½»å¿«çš„éŸ³æ•ˆ
            oscillator.frequency.setValueAtTime(800, now);
            gainNode.gain.setValueAtTime(0.15, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.08);
            oscillator.type = 'sine';
            oscillator.start(now);
            oscillator.stop(now + 0.08);
            break;
            
        case 'drop': // æ”¾ä¸‹å•è¯ - è½»æŸ”çš„éŸ³æ•ˆ
            oscillator.frequency.setValueAtTime(600, now);
            gainNode.gain.setValueAtTime(0.1, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            oscillator.type = 'sine';
            oscillator.start(now);
            oscillator.stop(now + 0.1);
            break;
            
        case 'complete': // å®Œæˆ - èƒœåˆ©æ—‹å¾‹
            const melody = [
                {freq: 523, time: 0},      // C5
                {freq: 659, time: 0.15},   // E5
                {freq: 784, time: 0.3},    // G5
                {freq: 1047, time: 0.45},  // C6
                {freq: 784, time: 0.6},    // G5
                {freq: 1047, time: 0.75}   // C6
            ];
            melody.forEach(note => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);
                osc.frequency.value = note.freq;
                gain.gain.setValueAtTime(0.2, now + note.time);
                gain.gain.exponentialRampToValueAtTime(0.01, now + note.time + 0.2);
                osc.start(now + note.time);
                osc.stop(now + note.time + 0.2);
            });
            return;
            
        case 'click': // ç‚¹å‡»æŒ‰é’® - è½»å¿«çš„åé¦ˆéŸ³
            oscillator.frequency.setValueAtTime(700, now);
            gainNode.gain.setValueAtTime(0.15, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            oscillator.type = 'sine';
            oscillator.start(now);
            oscillator.stop(now + 0.05);
            break;
            
        case 'dragover': // æ‹–åŠ¨æ‚¬åœ - å¾®å¦™çš„æç¤ºéŸ³
            oscillator.frequency.setValueAtTime(400, now);
            gainNode.gain.setValueAtTime(0.08, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            oscillator.type = 'sine';
            oscillator.start(now);
            oscillator.stop(now + 0.05);
            break;
    }
}

// å®Œæ•´çš„å•è¯åº“
const allWordsData = {
    fruit: ["apple", "banana", "orange", "grape", "mango", "peach", "pear", "lemon", "cherry", "strawberry", "watermelon", "pineapple"],
    animal: ["cat", "dog", "lion", "tiger", "elephant", "monkey", "rabbit", "bear", "fox", "wolf", "giraffe", "zebra"],
    color: ["red", "blue", "green", "yellow", "purple", "orange", "pink", "black", "white", "brown", "gray", "gold"],
    stationery: ["pen", "book", "pencil", "eraser", "ruler", "notebook", "crayon", "marker", "scissors", "glue", "stapler", "paper"],
    sport: ["football", "basketball", "tennis", "swimming", "running", "boxing", "skiing", "skating", "baseball", "volleyball", "golf", "hockey"],
    food: ["pizza", "burger", "pasta", "rice", "bread", "cheese", "chicken", "fish", "salad", "soup", "cake", "cookie"],
    vehicle: ["car", "bus", "train", "plane", "bicycle", "motorcycle", "truck", "boat", "ship", "helicopter", "subway", "taxi"],
    weather: ["sunny", "rainy", "cloudy", "snowy", "windy", "stormy", "foggy", "hot", "cold", "warm", "humid", "dry"]
};

const categoryNames = {
    fruit: "ğŸ æ°´æœ",
    animal: "ğŸ¾ åŠ¨ç‰©",
    color: "ğŸ¨ é¢œè‰²",
    stationery: "âœï¸ æ–‡å…·",
    sport: "âš½ è¿åŠ¨",
    food: "ğŸ” é£Ÿç‰©",
    vehicle: "ğŸš— äº¤é€šå·¥å…·",
    weather: "ğŸŒ¤ï¸ å¤©æ°”"
};

let score = 0;
let correctCount = 0;
let wrongCount = 0;
let difficulty = 'easy'; // easy, medium, hard
let currentWords = [];
let currentCategories = [];
let startTime;
let timerInterval;

// ç”Ÿæˆéšæœºæ¸¸æˆ
function generateGame() {
    clearInterval(timerInterval);
    const categoriesDiv = document.getElementById('categories');
    const wordsDiv = document.getElementById('words');
    categoriesDiv.innerHTML = '';
    wordsDiv.innerHTML = '';
    
    // æ ¹æ®éš¾åº¦é€‰æ‹©åˆ†ç±»æ•°é‡å’Œå•è¯æ•°é‡
    let numCategories, wordsPerCategory;
    if (difficulty === 'easy') {
        numCategories = 3;
        wordsPerCategory = 3;
    } else if (difficulty === 'medium') {
        numCategories = 4;
        wordsPerCategory = 4;
    } else {
        numCategories = 5;
        wordsPerCategory = 5;
    }
    
    // éšæœºé€‰æ‹©åˆ†ç±»
    const allCategories = Object.keys(allWordsData);
    const selectedCategories = [];
    while (selectedCategories.length < numCategories) {
        const randomCat = allCategories[Math.floor(Math.random() * allCategories.length)];
        if (!selectedCategories.includes(randomCat)) {
            selectedCategories.push(randomCat);
        }
    }
    
    currentCategories = selectedCategories;
    currentWords = [];
    
    // ä¸ºæ¯ä¸ªåˆ†ç±»åˆ›å»ºå®¹å™¨
    selectedCategories.forEach(cat => {
        const div = document.createElement('div');
        div.className = 'category';
        div.dataset.category = cat;
        div.innerHTML = `<h3>${categoryNames[cat]}</h3>`;
        
        div.addEventListener('dragover', e => {
            e.preventDefault();
            if (!div.classList.contains('drag-over')) {
                playSound('dragover');
            }
            div.classList.add('drag-over');
        });
        div.addEventListener('dragleave', () => {
            div.classList.remove('drag-over');
        });
        div.addEventListener('drop', e => {
            handleDrop(e, div);
        });
        
        categoriesDiv.appendChild(div);
        
        // ä»è¯¥åˆ†ç±»éšæœºé€‰æ‹©å•è¯
        const categoryWords = allWordsData[cat];
        const selectedWords = [];
        while (selectedWords.length < wordsPerCategory) {
            const randomWord = categoryWords[Math.floor(Math.random() * categoryWords.length)];
            if (!selectedWords.includes(randomWord)) {
                selectedWords.push(randomWord);
                currentWords.push({word: randomWord, category: cat});
            }
        }
    });
    
    // æ‰“ä¹±å•è¯é¡ºåº
    currentWords.sort(() => 0.5 - Math.random());
    
    // åˆ›å»ºå•è¯å…ƒç´ 
    currentWords.forEach((item, idx) => {
        const div = document.createElement('div');
        div.className = 'word';
        div.textContent = item.word;
        div.draggable = true;
        div.dataset.category = item.category;
        div.dataset.word = item.word;
        div.style.animationDelay = `${idx * 0.1}s`;
        
        div.addEventListener('dragstart', e => {
            e.dataTransfer.setData('word', item.word);
            e.dataTransfer.setData('category', item.category);
            playSound('pickup');
        });
        
        wordsDiv.appendChild(div);
    });
    
    // å¯åŠ¨è®¡æ—¶å™¨
    startTime = Date.now();
    updateTimer();
    timerInterval = setInterval(updateTimer, 1000);
}

function handleDrop(e, categoryDiv) {
    e.preventDefault();
    categoryDiv.classList.remove('drag-over');
    
    const wordText = e.dataTransfer.getData('word');
    const wordCategory = e.dataTransfer.getData('category');
    const targetCategory = categoryDiv.dataset.category;
    
    const wordDiv = document.querySelector(`.word[data-word="${wordText}"]`);
    if (!wordDiv || wordDiv.classList.contains('finished')) return;
    
    if (wordCategory === targetCategory) {
        // æ­£ç¡®éŸ³æ•ˆ
        playSound('correct');
        
        // æ­£ç¡®
        score += 10 * (difficulty === 'easy' ? 1 : difficulty === 'medium' ? 1.5 : 2);
        correctCount++;
        wordDiv.classList.add('correct');
        wordDiv.classList.add('finished');
        wordDiv.draggable = false;
        categoryDiv.appendChild(wordDiv);
        
        // åˆ›å»ºç²’å­æ•ˆæœ
        createParticles(e.clientX, e.clientY);
        
        // æ£€æŸ¥æ˜¯å¦å®Œæˆ
        checkCompletion();
    } else {
        // é”™è¯¯éŸ³æ•ˆ
        playSound('wrong');
        
        // é”™è¯¯
        wrongCount++;
        score = Math.max(0, score - 5);
        wordDiv.classList.add('wrong');
        setTimeout(() => wordDiv.classList.remove('wrong'), 500);
    }
    
    updateScore();
}

function createParticles(x, y) {
    const particlesDiv = document.getElementById('particles');
    const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8'];
    
    for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        particle.style.animationDelay = `${i * 0.05}s`;
        particle.style.transform = `rotate(${Math.random() * 360}deg)`;
        particlesDiv.appendChild(particle);
        
        setTimeout(() => particle.remove(), 2000);
    }
}

function updateScore() {
    document.getElementById('score').textContent = Math.round(score);
    document.getElementById('correct').textContent = correctCount;
    document.getElementById('wrong').textContent = wrongCount;
}

function updateTimer() {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
    const seconds = (elapsed % 60).toString().padStart(2, '0');
    document.getElementById('timer').textContent = `â±ï¸ æ—¶é—´: ${minutes}:${seconds}`;
}

function checkCompletion() {
    const remainingWords = document.querySelectorAll('.word:not(.finished)');
    if (remainingWords.length === 0) {
        clearInterval(timerInterval);
        // å®ŒæˆéŸ³æ•ˆ
        playSound('complete');
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        setTimeout(() => {
            alert(`ğŸ‰ æ­å–œå®Œæˆï¼\nå¾—åˆ†: ${Math.round(score)}\næ­£ç¡®: ${correctCount}\né”™è¯¯: ${wrongCount}\nç”¨æ—¶: ${elapsed}ç§’`);
        }, 500);
    }
}

function resetGame() {
    score = 0;
    correctCount = 0;
    wrongCount = 0;
    updateScore();
    generateGame();
}

function changeDifficulty() {
    const difficulties = ['easy', 'medium', 'hard'];
    const difficultyNames = {easy: 'ç®€å•', medium: 'ä¸­ç­‰', hard: 'å›°éš¾'};
    const currentIndex = difficulties.indexOf(difficulty);
    difficulty = difficulties[(currentIndex + 1) % 3];
    document.getElementById('difficultyBtn').textContent = `âš™ï¸ éš¾åº¦: ${difficultyNames[difficulty]}`;
    resetGame();
}

// åˆå§‹åŒ–
document.getElementById('resetBtn').onclick = () => {
    playSound('click');
    resetGame();
};

document.getElementById('difficultyBtn').onclick = () => {
    playSound('click');
    changeDifficulty();
};

// éŸ³æ•ˆå¼€å…³
document.getElementById('soundBtn').onclick = () => {
    soundEnabled = !soundEnabled;
    const btn = document.getElementById('soundBtn');
    btn.textContent = soundEnabled ? 'ğŸ”Š éŸ³æ•ˆ' : 'ğŸ”‡ é™éŸ³';
    if (soundEnabled) playSound('click');
};

generateGame();
</script>

</body>
</html>
